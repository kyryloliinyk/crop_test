<%= link_to('<â€“ all fields', fields_path) %>

<h1><%= @field.name %></h1>
<p>Area: <%= @field.area %> square meters</p>

<div id="map" style="height: 400px;"></div>

<script>
  document.addEventListener('turbo:load', function() {
    console.log("Turbo load event triggered");
    var map = L.map('map').setView([0, 0], 2);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    var polygon = <%= raw @geojson %>;
    console.log("GeoJSON data:", polygon);

    var geoJsonLayer = L.geoJSON(polygon);
    geoJsonLayer.addTo(map);
    console.log("GeoJSON layer added to map");

    map.fitBounds(geoJsonLayer.getBounds());
    console.log("Map bounds set");
  });
</script>
